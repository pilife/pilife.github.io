<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en,zh-Hans,default">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="YouShouldKnow" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2">






<meta property="og:type" content="website">
<meta property="og:title" content="YouShouldKnow">
<meta property="og:url" content="http://blog.youshouldknow.tech/index.html">
<meta property="og:site_name" content="YouShouldKnow">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="YouShouldKnow">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.youshouldknow.tech/">





  <title>YouShouldKnow</title>
  














</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">YouShouldKnow</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">The world is wonderful, you should know more</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.youshouldknow.tech/2019/03/15/不懂这些，计算机网络你可能一无所知/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frank Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/zy_avatar.jepg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YouShouldKnow">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/15/不懂这些，计算机网络你可能一无所知/" itemprop="url">不懂这些，计算机网络你可能一无所知?</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-15T21:45:17+08:00">
                2019-03-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/youshouldknow/" itemprop="url" rel="index">
                    <span itemprop="name">youshouldknow</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>网络分层</p>
<p>| Layer       | Protocol                |<br>| ———– | ———————– |<br>| Application | Telnet, FTP, etc        |<br>| Transport   | TCP, UDP                |<br>| Network     | IP, ICMP                |<br>| Link        | drivers, interface card |</p>
</li>
<li><p>数据的单元：报文，报文段，分组/包，数据报，帧，数据单元</p>
<ul>
<li>Application Layer -&gt; 报文（message）</li>
<li>Transport Layer -&gt; TCP -&gt; 报文段（segment）</li>
<li>Transport/Network Layer -&gt; UDP/ IP -&gt; 数据报（datagram）</li>
<li>Transport/Network Layer -&gt; 分组/包（packet）</li>
<li>Link Layer -&gt; 帧（frame）</li>
</ul>
</li>
<li><p>TCP</p>
<ol>
<li><p>TCP Segment</p>
<p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1g13ip2xmihj30kp072jrj.jpg" alt="img"></p>
<p>以太网数据包（frame）的大小是固定的，最初是1518字节，后来增加到1522字节。其中， 1500 字节是负载（payload），22字节是头信息（head）。</p>
<p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1g13j80o5d6g30bm06qmwy.gif" alt="ip packet"></p>
<p>IP 数据包在以太网数据包的负载里面，它也有自己的头信息，最少需要20字节，所以 IP 数据包的负载最多为1480字节。</p>
<p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1g13j7708d2g30b708i3yb.gif" alt="tcp packet"></p>
<p>TCP 数据包在 IP 数据包的负载里面。它的头信息最少也需要20字节，因此 TCP 数据包的最大负载是 1480 - 20 = 1460 字节。由于 IP 和 TCP 协议往往有额外的头信息，所以 TCP 负载实际为1400字节左右。</p>
<p>因此，一条1500字节的信息需要两个 TCP 数据包。HTTP/2 协议的一大改进， 就是压缩 HTTP 协议的头信息，使得一个 HTTP 请求可以放在一个 TCP 数据包里面，而不是分成多个，这样就提高了速度。</p>
<p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1g13ivy3aetj30ix08j3yf.jpg" alt="img"></p>
</li>
<li><p>流程</p>
<ol>
<li>建立连接：三次握手</li>
<li>发送数据<ol>
<li>滑动窗口</li>
<li>慢启动</li>
</ol>
</li>
<li>断开连接：四次挥手</li>
</ol>
</li>
<li><p>优点</p>
<ul>
<li>面向连接</li>
<li>具备顺序控制</li>
<li>重发控制等机制</li>
</ul>
</li>
<li><p>应用场景</p>
<p>可以为应用提供可靠的传输。</p>
</li>
</ol>
</li>
<li><p>UDP</p>
<ol>
<li><p>UDP packet</p>
<p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1g13jpm4luog30aa03a3y9.gif" alt="img"></p>
</li>
<li><p>流程</p>
</li>
<li><p>优点</p>
<blockquote>
<p>UDP数据包长度</p>
<p>在本机(loopback)传输，可以根据需要设置MTU，但记住，UDP最大理论长度65507。</p>
<p>在内网传输，最好控制在1472字节(1500-8-20)。</p>
<p>在internet上传输，最好控制在548字节(576-8-20)以内。</p>
</blockquote>
<blockquote>
<p> UDP收包能力</p>
<p>UDP处理能力非常可观，在日常的业务情形中，UDP一般不会成为性能瓶颈。</p>
<p>随着进程个数的增加，处理能力未明显上升，但是丢包个数明显下降。</p>
<p>采用多进程监听不同端口的模型，而不是多进程或多线程监听同一个端口。</p>
</blockquote>
</li>
<li><p>应用场景</p>
<p>media streaming </p>
</li>
</ol>
</li>
<li><p>IP分片与重组</p>
</li>
</ul>
<p>Reference:</p>
<blockquote>
<p><a href="https://stackoverflow.com/questions/11636405/definition-of-network-units-fragment-segment-packet-frame-datagram" target="_blank" rel="noopener">Exploring the anatomy of a data packet</a></p>
<p><a href="https://www.techrepublic.com/article/exploring-the-anatomy-of-a-data-packet/" target="_blank" rel="noopener">Definition of Network Units: Fragment, Segment, Packet, Frame, Datagram</a></p>
<p><a href="https://blog.csdn.net/github_35124642/article/details/52006185" target="_blank" rel="noopener">IP分片和重组</a></p>
<p><a href="https://www.cnblogs.com/linuxbug/p/4906000.html" target="_blank" rel="noopener">浅谈UDP(数据包长度，收包能力，丢包及进程结构选择)</a></p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.youshouldknow.tech/2019/02/19/吉他练习心得（从新手成长进阶的过程和总结）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frank Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/zy_avatar.jepg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YouShouldKnow">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/19/吉他练习心得（从新手成长进阶的过程和总结）/" itemprop="url">吉他练习心得（从新手成长进阶的过程和总结）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-19T13:45:24+08:00">
                2019-02-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/音乐/" itemprop="url" rel="index">
                    <span itemprop="name">音乐</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.youshouldknow.tech/2019/02/19/乐理知识整理（持续学习中）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frank Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/zy_avatar.jepg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YouShouldKnow">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/19/乐理知识整理（持续学习中）/" itemprop="url">乐理知识整理（持续学习中）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-19T13:44:24+08:00">
                2019-02-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/音乐/" itemprop="url" rel="index">
                    <span itemprop="name">音乐</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>[TOC]</p>
<h2 id="大白话音乐的基本概念"><a href="#大白话音乐的基本概念" class="headerlink" title="大白话音乐的基本概念"></a>大白话音乐的基本概念</h2><h3 id="声音的物理原理"><a href="#声音的物理原理" class="headerlink" title="声音的物理原理"></a>声音的物理原理</h3><p>声音是一种波，所以由<u>振幅，频率，相位</u></p>
<p><em>振幅</em>就是通常所说的<strong>音量(volume)</strong></p>
<p><em>频率</em>则是<strong>音高(pitch)</strong></p>
<p>波的叠加产生了不同的<strong>音色(timbre)</strong>，这里也涉及到了不同<em>相位波的叠加</em></p>
<h3 id="音乐的三要素"><a href="#音乐的三要素" class="headerlink" title="音乐的三要素"></a>音乐的三要素</h3><p>节奏，旋律，和声</p>
<p>节奏是音乐的生命</p>
<p>旋律是音乐的感情走向</p>
<p>和声是使音乐表现力更加丰富</p>
<h3 id="音高的划分—12平均律"><a href="#音高的划分—12平均律" class="headerlink" title="音高的划分—12平均律"></a>音高的划分—12平均律</h3><h3 id="音名，唱名"><a href="#音名，唱名" class="headerlink" title="音名，唱名"></a>音名，唱名</h3><h3 id="为什么划分这些唱名？"><a href="#为什么划分这些唱名？" class="headerlink" title="为什么划分这些唱名？"></a>为什么划分这些唱名？</h3><h3 id="和弦"><a href="#和弦" class="headerlink" title="和弦"></a>和弦</h3><h3 id="常用和弦进行"><a href="#常用和弦进行" class="headerlink" title="常用和弦进行"></a>常用和弦进行</h3><h3 id="什么是调？C调，D调，XX调到底是啥"><a href="#什么是调？C调，D调，XX调到底是啥" class="headerlink" title="什么是调？C调，D调，XX调到底是啥"></a>什么是调？C调，D调，XX调到底是啥</h3><h2 id="识谱，不要做文盲！"><a href="#识谱，不要做文盲！" class="headerlink" title="识谱，不要做文盲！"></a>识谱，不要做文盲！</h2><h3 id="五线谱：音乐的语言"><a href="#五线谱：音乐的语言" class="headerlink" title="五线谱：音乐的语言"></a>五线谱：音乐的语言</h3><h3 id="六线谱：万一按错了呢，还是要这个纠正下"><a href="#六线谱：万一按错了呢，还是要这个纠正下" class="headerlink" title="六线谱：万一按错了呢，还是要这个纠正下"></a>六线谱：万一按错了呢，还是要这个纠正下</h3><h2 id="练琴心得"><a href="#练琴心得" class="headerlink" title="练琴心得"></a>练琴心得</h2><h3 id="关于爬格子"><a href="#关于爬格子" class="headerlink" title="关于爬格子"></a>关于爬格子</h3><p>必要性：顶尖的大师，每天也都会爬格子，何况吾等。能够让你的手指灵活，有力，独立。</p>
<p>推荐爬格子方法：从60开始，声音饱满节奏稳定以后提速5，正常爬格子速度一般练到100+ ，保留指爬格子一般练到80速左右。 节拍使用四四拍，四分音符，每个音符弹两下。</p>
<p>爬格子注意：一定要集中注意力爬格子！！一定要集中注意力爬格子！！一定要集中注意力爬格子！！不要以为这是机械的动作就不要注意力了，集中注意，打开手指，努力张开到最大，按的最接近品柱。不然爬格子并不会带来上述收益。</p>
<p>对了，很努力的爬格子之后，再按和弦会感觉手指很灵活，很轻松。和健身做完大重量做小重量类似的感觉。</p>
<h3 id="关于单音练习"><a href="#关于单音练习" class="headerlink" title="关于单音练习"></a>关于单音练习</h3><p>在谈的时候，放空大脑，感受指尖的飞舞，啊～Stop！单音练习一定要把谈的音唱出来，这样才能增加音名和指板位置的map的熟悉度。最后可以做到<strong>视谱</strong>就靠这个了。</p>
<h2 id="小机灵鬼的问题"><a href="#小机灵鬼的问题" class="headerlink" title="小机灵鬼的问题"></a>小机灵鬼的问题</h2><ol>
<li><p>音色是什么？</p>
<p>谐波</p>
</li>
<li><p>为什么有的分解和弦，最后的音会变成空弦？</p>
<p>因为吉他手为了转换和弦的方便，提前移走了。由于不是根音（音乐的创作原理），影响不是很大就可以接受，而且可能会有意想不到的效果哦。</p>
</li>
<li><p>为什么要学习不同的调的指法呢，变调夹不是能解决一切么？</p>
<p>变调夹虽然很厉害，让你只会C调的指法（音阶在指板上的位置熟悉），却可以弹其他调。但是！！如果一首歌有好几个调呢，难道你要快速移动变调夹吗HH。所以不要偷懒机灵鬼们。</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.youshouldknow.tech/2019/02/19/健身理论OverView/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frank Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/zy_avatar.jepg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YouShouldKnow">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/19/健身理论OverView/" itemprop="url">健身理论OverView</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-19T13:42:24+08:00">
                2019-02-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/健身/" itemprop="url" rel="index">
                    <span itemprop="name">健身</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.youshouldknow.tech/2019/02/19/2018-11-inch-ipad-pro/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frank Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/zy_avatar.jepg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YouShouldKnow">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/19/2018-11-inch-ipad-pro/" itemprop="url">2018 11 inch ipad pro</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-19T13:37:57+08:00">
                2019-02-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/tech-experiment/" itemprop="url" rel="index">
                    <span itemprop="name">tech experiment</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.youshouldknow.tech/2019/01/13/protocol-buffers/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frank Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/zy_avatar.jepg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YouShouldKnow">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/13/protocol-buffers/" itemprop="url">protocol buffers</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-01-13T03:54:44+08:00">
                2019-01-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/tools/" itemprop="url" rel="index">
                    <span itemprop="name">tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本教程旨在让我们学会：</p>
<ol>
<li>定义一个.proto文件</li>
<li>使用 protocol buffer complier</li>
<li>用户 Java protocol buffer API 来读写信息</li>
</ol>
<h4 id="首先我们结合实际的应用场景来了解一下，为什么需要protocol-buffers"><a href="#首先我们结合实际的应用场景来了解一下，为什么需要protocol-buffers" class="headerlink" title="首先我们结合实际的应用场景来了解一下，为什么需要protocol buffers?"></a>首先我们结合实际的应用场景来了解一下，为什么需要protocol buffers?</h4><p>这里我们是用一个通讯录对文件的读写来完成对用户通讯信息的读写的例子作为介绍。</p>
<p>当我们要序列化和以及恢复这种有结构的数据，有如下几种方法。</p>
<ul>
<li>利用Java的序列化机制。但是存在如下问题：<ul>
<li>存在许多众所周知的问题 (see Effective Java, by Josh Bloch pp. 213)</li>
<li>不能很好地和其他语言C++/Python共享数据（和语言的耦合性太高）</li>
</ul>
</li>
<li>自定义一个特定的（ad-hoc）方式把数据项编码成一个字符串。比如将四个整数编码为”12:3:-23:67”。这是一种简单而灵活的方法，尽管它需要编写一次性（这里的英文是one-off, 意思为happen only once，我理解是只适用于这个场景的解码和编码方法，因此翻译为一次性的）的编码和解码的代码，而且解码会产生很小的运行时间成本。所以这种方式很适合编码简单的数据。</li>
<li>将数据序列化为XML。 这种方法可能非常有吸引力，因为XML是可读的，并且有许多语言的绑定库。 如果您想与其他应用程序/项目共享数据，这可能是一个不错的选择。 然而，XML是众所周知的空间密集型，<u>编码/解码可能会给应用程序带来巨大的性能损失</u>。 另外，导航XML DOM树比导航类中的简单字段通常要复杂得多。</li>
</ul>
<p>Protocol buffers是解决这个问题的灵活，高效的自动化解决方案。</p>
<p>你只需要写一个你想要存储的数据结构的描述.proto文件。之后protocol buffer compiler会创建一个类。这个类</p>
<ol>
<li>用高效的二进制格式实现了自动编码和解码。</li>
<li>对字段提供了getters和setters。</li>
<li>将读写的细节作为一个单元处理</li>
<li>支持拓展格式，并且保持对旧的编码的数据读取的兼容。</li>
</ol>
<h4 id="下面介绍具体的使用："><a href="#下面介绍具体的使用：" class="headerlink" title="下面介绍具体的使用："></a>下面介绍具体的使用：</h4><ul>
<li><p>定义.proto文件的方式</p>
<ul>
<li>Extend info<ul>
<li>package（区分不同project）</li>
<li>java_package（java的包, default=package）</li>
<li>java_outer_classname（java的类名, default=filename2camelcase）</li>
</ul>
</li>
<li>Massage declaration<ul>
<li>field types(default value): bool(false), int32(0), float(0), double(0), string(“”)</li>
<li>enum定义</li>
<li>tag: field在二进制编码中使用的标记。所以1-15（需要少于一个字节）一般赋予常用的和repeated的元素。&gt;=16的给一些不常使用的optional元素。</li>
<li>modifiers: required(少用，对拓展限制很强), optional, repeated</li>
</ul>
</li>
</ul>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">syntax = <span class="string">"proto2"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> tutorial;</span><br><span class="line"></span><br><span class="line"><span class="keyword">option</span> java_package = <span class="string">"com.example.tutorial"</span>;</span><br><span class="line"><span class="keyword">option</span> java_outer_classname = <span class="string">"AddressBookProtos"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">required</span> <span class="built_in">string</span> name = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">required</span> <span class="built_in">int32</span> id = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">optional</span> <span class="built_in">string</span> email = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">enum</span> <span class="title">PhoneType</span> </span>&#123;</span><br><span class="line">    MOBILE = <span class="number">0</span>;</span><br><span class="line">    HOME = <span class="number">1</span>;</span><br><span class="line">    WORK = <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">message</span> <span class="title">PhoneNumber</span> </span>&#123;</span><br><span class="line">    <span class="keyword">required</span> <span class="built_in">string</span> number = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">optional</span> PhoneType type = <span class="number">2</span> [default = HOME];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">repeated</span> PhoneNumber phones = <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">AddressBook</span> </span>&#123;</span><br><span class="line">  <span class="keyword">repeated</span> Person people = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编译该文件(-I用于import)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protoc -I=$SRC_DIR --java_out=$DST_DIR $SRC_DIR/addressbook.proto</span><br></pre></td></tr></table></figure>
</li>
<li><p>生成的Class文件如何使用（生成了什么，提供了什么功能）</p>
<ul>
<li><p>生成了Message对应的class。每个class有自己的Builder。且由protocol compiler生成的类都是对应JAVA风格的驼峰命名。<u>这里建议在.proto文件中使用小写字母+下划线</u>。（因为protocol compiler是在小写字母+下划线规范上，解析生成对应语言的风格的代码）</p>
</li>
<li><p>Message: 信息对象，immutable，不可被修改</p>
<ul>
<li>Singular field: has, get</li>
<li>Repeated fields: getList, getCount, get(index)</li>
<li>标准方法，Message接口声明的<ul>
<li>isInitialized(): checks if all the required fields have been set.</li>
<li>toString(): returns a human-readable representation of the message, particularly useful for debugging</li>
</ul>
</li>
<li>序列化和解码<ul>
<li>byte[] toByteArray();: serializes the message and returns a byte array containing its raw bytes.</li>
<li>static Person parseFrom(byte[] data);: parses a message from the given byte array.</li>
<li>void writeTo(OutputStream output);: serializes the message and writes it to an OutputStream.</li>
<li>static Person parseFrom(InputStream input);: reads and parses a message from an InputStream.</li>
</ul>
</li>
</ul>
</li>
<li><p>Builder: 信息对象的构造器，用来创建massage对象</p>
<ul>
<li>Singular field: has, get, set, clear</li>
<li>Repeated fields: getList, getCount, get(index), set(index, value), add(value), addAll(value), clear</li>
<li>标准方法，Message.Builder接口声明的<ul>
<li>isInitialized()</li>
<li>toString()</li>
<li>mergeFrom(Message other):  merges the contents of other into this message, overwriting singular scalar fields, merging composite fields, and concatenating repeated fields</li>
<li>clear(): clears all the fields back to the empty state</li>
</ul>
</li>
</ul>
</li>
<li><p>Enums and Nested Classes:</p>
<p>枚举类型会自动在声明的类的内部生成</p>
</li>
</ul>
<blockquote>
<p>由于协议缓冲区类基本上是哑数据持有者（如C中的strcuts），所以注意这里要拓展数据类的功能，比如添加一些行为，不可以通过继承的方式，因为这将打破protocol buffer内部的机制。可以通过包装(wrap)数据类到特定于应用程序的类中。（适配器模式）</p>
</blockquote>
</li>
<li><p>尝试写入文件</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.example.tutorial.AddressBookProtos.AddressBook;</span><br><span class="line"><span class="keyword">import</span> com.example.tutorial.AddressBookProtos.Person;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddPerson</span> </span>&#123;</span><br><span class="line">  <span class="comment">// This function fills in a Person message based on user input.</span></span><br><span class="line">  <span class="function"><span class="keyword">static</span> Person <span class="title">PromptForAddress</span><span class="params">(BufferedReader stdin,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 PrintStream stdout)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    Person.Builder person = Person.newBuilder();</span><br><span class="line"></span><br><span class="line">    stdout.print(<span class="string">"Enter person ID: "</span>);</span><br><span class="line">    person.setId(Integer.valueOf(stdin.readLine()));</span><br><span class="line"></span><br><span class="line">    stdout.print(<span class="string">"Enter name: "</span>);</span><br><span class="line">    person.setName(stdin.readLine());</span><br><span class="line"></span><br><span class="line">    stdout.print(<span class="string">"Enter email address (blank for none): "</span>);</span><br><span class="line">    String email = stdin.readLine();</span><br><span class="line">    <span class="keyword">if</span> (email.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      person.setEmail(email);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">      stdout.print(<span class="string">"Enter a phone number (or leave blank to finish): "</span>);</span><br><span class="line">      String number = stdin.readLine();</span><br><span class="line">      <span class="keyword">if</span> (number.length() == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      Person.PhoneNumber.Builder phoneNumber =</span><br><span class="line">        Person.PhoneNumber.newBuilder().setNumber(number);</span><br><span class="line"></span><br><span class="line">      stdout.print(<span class="string">"Is this a mobile, home, or work phone? "</span>);</span><br><span class="line">      String type = stdin.readLine();</span><br><span class="line">      <span class="keyword">if</span> (type.equals(<span class="string">"mobile"</span>)) &#123;</span><br><span class="line">        phoneNumber.setType(Person.PhoneType.MOBILE);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(<span class="string">"home"</span>)) &#123;</span><br><span class="line">        phoneNumber.setType(Person.PhoneType.HOME);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(<span class="string">"work"</span>)) &#123;</span><br><span class="line">        phoneNumber.setType(Person.PhoneType.WORK);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        stdout.println(<span class="string">"Unknown phone type.  Using default."</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      person.addPhones(phoneNumber);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> person.build();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Main function:  Reads the entire address book from a file,</span></span><br><span class="line">  <span class="comment">//   adds one person based on user input, then writes it back out to the same</span></span><br><span class="line">  <span class="comment">//   file.</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (args.length != <span class="number">1</span>) &#123;</span><br><span class="line">      System.err.println(<span class="string">"Usage:  AddPerson ADDRESS_BOOK_FILE"</span>);</span><br><span class="line">      System.exit(-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    AddressBook.Builder addressBook = AddressBook.newBuilder();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Read the existing address book.</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      addressBook.mergeFrom(<span class="keyword">new</span> FileInputStream(args[<span class="number">0</span>]));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">      System.out.println(args[<span class="number">0</span>] + <span class="string">": File not found.  Creating a new file."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add an address.</span></span><br><span class="line">    addressBook.addPeople(</span><br><span class="line">      PromptForAddress(<span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in)),</span><br><span class="line">                       System.out));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Write the new address book back to disk.</span></span><br><span class="line">    FileOutputStream output = <span class="keyword">new</span> FileOutputStream(args[<span class="number">0</span>]);</span><br><span class="line">    addressBook.build().writeTo(output);</span><br><span class="line">    output.close();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>尝试读取文件</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.example.tutorial.AddressBookProtos.AddressBook;</span><br><span class="line"><span class="keyword">import</span> com.example.tutorial.AddressBookProtos.Person;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintStream;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListPeople</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Iterates though all people in the AddressBook and prints info about them.</span></span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Print</span><span class="params">(AddressBook addressBook)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (Person person: addressBook.getPeopleList()) &#123;</span><br><span class="line">      System.out.println(<span class="string">"Person ID: "</span> + person.getId());</span><br><span class="line">      System.out.println(<span class="string">"  Name: "</span> + person.getName());</span><br><span class="line">      <span class="keyword">if</span> (person.hasEmail()) &#123;</span><br><span class="line">        System.out.println(<span class="string">"  E-mail address: "</span> + person.getEmail());</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (Person.PhoneNumber phoneNumber : person.getPhonesList()) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (phoneNumber.getType()) &#123;</span><br><span class="line">          <span class="keyword">case</span> MOBILE:</span><br><span class="line">            System.out.print(<span class="string">"  Mobile phone #: "</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> HOME:</span><br><span class="line">            System.out.print(<span class="string">"  Home phone #: "</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> WORK:</span><br><span class="line">            System.out.print(<span class="string">"  Work phone #: "</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(phoneNumber.getNumber());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Main function:  Reads the entire address book from a file and prints all</span></span><br><span class="line">  <span class="comment">//   the information inside.</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (args.length != <span class="number">1</span>) &#123;</span><br><span class="line">      System.err.println(<span class="string">"Usage:  ListPeople ADDRESS_BOOK_FILE"</span>);</span><br><span class="line">      System.exit(-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Read the existing address book.</span></span><br><span class="line">    AddressBook addressBook =</span><br><span class="line">      AddressBook.parseFrom(<span class="keyword">new</span> FileInputStream(args[<span class="number">0</span>]));</span><br><span class="line"></span><br><span class="line">    Print(addressBook);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>如何拓展一个protocol buffer（新buffers向下兼容，旧buffers向上兼容）(<u><strong>考虑的是新旧代码上的兼容</strong></u>)</p>
<ul>
<li>you <em>must not</em> change the tag numbers of any existing fields.</li>
<li>you <em>must not</em> add or delete any required fields.</li>
<li>you <em>may</em> delete optional or repeated fields.</li>
<li>you <em>may</em> add new optional or repeated fields but you must use fresh tag numbers (i.e. tag numbers that were never used in this protocol buffer, not even by deleted fields).</li>
</ul>
<p>对于删除的可选字段</p>
<ul>
<li>读取新的文件时，旧代码设置为默认值，如果没有默认值，则是对应类型的默认值。重复字段为空。</li>
<li>读取旧的文件时，新代码会透明读取，即忽略被删除的字段。</li>
</ul>
<p>对于新增的可选字段</p>
<ul>
<li>读取新的文件时，旧代码会透明读取，即忽略被删除的字段。</li>
<li>读取旧的文件时，新代码设置为默认值，如果没有默认值，则是对应类型的默认值。重复字段为空。</li>
</ul>
</li>
<li><p>高级应用（反射）【以下为google翻译】</p>
<p>协议消息类提供的一个关键特性是反射。 您可以迭代消息的字段并操作它们的值，而无需针对任何特定消息类型编写代码。 使用反射的一个非常有用的方法是将协议消息转换为其他编码（例如XML或JSON）以及从其他编码转换。 更高级的反射使用可能是找到两个相同类型的消息之间的差异，或者开发一种“协议消息的正则表达式”，在其中可以编写匹配特定消息内容的表达式。 如果您使用自己的想象力，可以将Protocol Buffers应用于比您最初期望的更广泛的问题！</p>
</li>
</ul>
<h4 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h4><p>本质上就是提供了一个中间层，完成数据的定义和数据在具体代码中实现（提供的API：getset，序列化，解码编码，builder-merge等）的解耦。</p>
<h4 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h4><p><a href="https://developers.google.com/protocol-buffers/docs/javatutorial" target="_blank" rel="noopener">protocol buffers java tutorial</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.youshouldknow.tech/2019/01/13/some-exprience-about-hexo-first-use-it/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Frank Zhang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/zy_avatar.jepg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YouShouldKnow">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/13/some-exprience-about-hexo-first-use-it/" itemprop="url">hexo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-01-13T02:23:02+08:00">
                2019-01-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/tools/" itemprop="url" rel="index">
                    <span itemprop="name">tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/zy_avatar.jepg" alt="Frank Zhang">
          <p class="site-author-name" itemprop="name">Frank Zhang</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/pilife" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/zhang-yi-14-85-5/activities" target="_blank" title="ZhiHu">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                    
                      ZhiHu
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Frank Zhang</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
